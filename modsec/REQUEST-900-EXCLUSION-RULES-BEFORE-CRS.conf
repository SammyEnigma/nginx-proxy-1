
# Elementor
# XSS using libinjection. When saving/updating elementor post
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin-ajax.php" \
    "id:890001,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=932130,\
    ctl:ruleRemoveById=941100,\
    ctl:ruleRemoveById=941160"

# Exclusions for WP Pages saves
SecRule REQUEST_FILENAME "@rx /wp-json/wp/v2/(pages|posts)/[0-9]+(/autosaves)?" \
    "id:890002,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=921110,\
    ctl:ruleRemoveById=930110,\
    ctl:ruleRemoveById=932110,\
    ctl:ruleRemoveById=932130,\
    ctl:ruleRemoveById=941100,\
    ctl:ruleRemoveById=941160,\
    ctl:ruleRemoveById=941180"

# Exclusions for WP Pages saves
# Fix various "Path Traversal Attack (/../)"'
SecRule REQUEST_FILENAME "@endsWith /wp-admin/async-upload.php" \
    "id:890003,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveById=930100,\
    ctl:ruleRemoveById=930110"

# WP Contact Form 7 Whitelisting
SecRule REQUEST_FILENAME "@endsWith /wp-admin/admin.php" \
    "id:890004,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=941180;ARGS:wpcf7-form"
SecRule REQUEST_FILENAME "@rx /wp-json/contact-form-7/v1/contact-forms/[0-9]+" \
    "id:890005,\
    phase:2,\
    pass,\
    t:none,\
    nolog,\
    ctl:ruleRemoveTargetById=941180;ARGS:form"
